=========================================================
Chapel HSA: Examples Demonstrating HSA Support for Chapel
=========================================================

This directory contains a few simple example codes to show how execution
can be offloaded to a GPU using the hierarchical hsa locale.
The CHPL_LOCALE_MODEL should be set to 'hsa'.
The $(CHPL_HOME)/util/setchplenv_hsa.chpl sets up a suitable environment for
GPU offload.

Example programs:

     hello-sublocale.chpl  : say hello from the hsa sublocales
     array-reduce.chpl     : gpu-offload of 1D-array reduction
     array-assign.chpl     : gpu-offload of parallel element-wise array assignment
     array-forall.chpl     : gpu-offload of array element assignment using forall
     loopy.chpl            : gpu-offload of a simple forall loop
     loopy-nested.chpl     : gpu-offload of a forall loop that calls other fns
     loopy-recursive.chpl  : a forall loop that calls other fns recursively.
                             This cannot be offloaded to a GPU
     loopy-strided.chpl    : gpu-offload of a forall loop with strided access
     loopy-filtered.chpl   : gpu-offload of a forall loop with filtering
     zip-forall.chpl       : gpu-offload of a zippered forall loop
     promotion.chpl        : gpu-offload for promotion of a scalar function
                             to operate on arrays



---------------------
Building the examples
---------------------

The examples can be compiled without explicitly listing any
additional source files.  For example, the canonical "Hello, world!"
program can be compiled as follows:

     chpl -o hello hello-sublocale.chpl --no-bounds-checks --no-local-checks --report-gpu-for-loops

The --no-bounds-checks and --no-local-checks options are required for
successful gpu codegen in many cases. These options insert runtime checks that
might result in error messages during execution. We haven't handled error
messages inside GPU yet. The --report-gpu-for-loops option is recommended,
since it makes the compiler report the sucess / failure status for each
parallel construct that it tried to offload to gpu.

